knitr::opts_chunk$set(echo = TRUE)
listings_crime_dataset <-read.csv("../../temp-data/analysis/listings_crime_dataset.csv")
#Load all libraries we need here, in one code chunk even if they are used in different sections
library(dplyr)
library(ggplot2)
library(tidyverse)
library(broom)
x = nrow(listings_crime_dataset)
x_neigh = nrow(listings_crime_dataset %>%group_by(neighborhood) %>% summarise(count=n()))
x_period = nrow(listings_crime_dataset %>%group_by(periods) %>% summarise(count=n()))
df_listings = listings_crime_dataset %>% group_by(neighborhood) %>% summarise(total_listings = sum(listing_sum))
df_max_listings = df_listings[which.max(df_listings$total_listings),]
n_m_l = df_max_listings[1,1]
n_m_l_n = df_max_listings[1,2]
df_min_listings = df_listings[which.min(df_listings$total_listings),]
n_l_l = df_min_listings[1,1]
n_l_l_n = df_min_listings[1,2]
df_price = listings_crime_dataset %>% group_by(neighborhood) %>% summarise(average_price)
df_max_price = df_price[which.max(df_price$average_price),]
n_m_p = df_max_price[1,1]
n_m_p_n = df_max_price[1,2]
df_min_price = df_price[which.min(df_price$average_price),]
n_l_p = df_min_price[1,1]
n_l_p_n = df_min_price[1,2]
var_tab <- "
| Variable      | Description   | Data Class |
|---------------|:-------------:|----------:|
| neighborhood      | The respective neighborhood in Amsterdam to which the data pertains to. | Character |
| listing_sum      | The total amount of listings in the respective neighborhood. | Integer |
| average_price | The average price for listings in the respective neighborhood. | Integer |
| percentage_home_apt | The percentage of listings that are home apartments out of the amount of total listings. | Numeric |
| percentage_hotel_rool | The percentage of listings that are hotel rooms out of the amount of total listings. | Numeric |
| percentage_private_room | The percentage of listings that are private rooms out of the amount of total listings. | Numeric |
| percentage_shared_room | The percentage of listings that are shared rooms out of the amount of total listings. | Numeric |
| periods | The periods of time to which crime data pertains to. | Character |
| crime_type_category | The type of crime to which the data pertains to. | Character |
| total_crime_sum | The amount of crime occurances of a certain type in a certain period. | Integer |
"
cat(var_tab)
df_crime_time = filter(listings_crime_dataset, crime_type_category == "Total") %>% group_by(periods) %>% summarise(total_crime = sum(total_crime_sum))
df_crime_time%>%
ggplot(aes(x = periods, y = total_crime, group = 1)) + geom_point() + geom_path() +
labs(x = "Periods (Month)", y = "Total Crime Cases" , title = "Total Crime Occurrences per Month") +
theme(axis.text.x=element_text(size = 8))
df_min_crime_time = df_crime_time[which.min(df_crime_time$total_crime),]
c_l_p = df_min_crime_time[1,1]
c_l_p_n = df_min_crime_time[1,2]
df_max_crime_time = df_crime_time[which.max(df_crime_time$total_crime),]
c_m_p = df_max_crime_time[1,1]
c_m_p_n = df_max_crime_time[1,2]
df_crime_type = filter(listings_crime_dataset, crime_type_category != "Total") %>% group_by(crime_type_category) %>% summarise(total_crime_sum = sum(total_crime_sum))
df_crime_type %>%
ggplot(aes(x = crime_type_category, y = total_crime_sum, fill = crime_type_category)) + geom_bar(stat = 'identity') +
labs(x = "Crime Type", y = "Crime Occurances", fill = "Crime Type", title = "Total Crime Occurances per Crime Category") +
scale_fill_viridis_d() + theme(axis.text.x=element_text(size = 8))
df_min_crime_type = df_crime_type[which.min(df_crime_type$total_crime_sum),]
c_l_t = df_min_crime_type[1,1]
c_l_t_n = df_min_crime_type[1,2]
df_max_crime_type = df_crime_type[which.max(df_crime_type$total_crime_sum),]
c_m_t = df_max_crime_type[1,1]
c_m_t_n = df_max_crime_type[1,2]
regression_dataset <- listings_crime_dataset %>%
filter(crime_type_category == "Total")
lr <- lm(total_crime_sum ~ listing_sum + neighborhood, data = listings_crime_dataset)
table_lr <- tidy(lr,conf.int = FALSE)
table_lr <- na.omit(table_lr)
table_lr <- table_lr %>% mutate(term = str_replace_all(term, "neighborhood",""))
print(table_lr)
sig_neigh <- list()
for (row in 1:nrow(table_lr)) {
p.val <-table_lr[row,"p.value"]
if(p.val < 0.05) {
sig_neigh <- c(sig_neigh, table_lr[row,"term"])}
}
sig_neigh <- sig_neigh[-1]
if (table_lr[2,5] < 0.05) {
print("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", table_lr[2,5] , ".")
}
if (table_lr[2,5] < 0.05) {
print("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", str(table_lr[2,5]) , ".")
}
if (table_lr[2,5] < 0.05) {
cat("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", table_lr[2,5], ".")
}
listing_sum_p <- table_lr[2,5]
listing_sum_p <- table_lr[2,5]
if (listing_sum_p < 0.05) {
cat("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p, ".")
}
listing_sum_p <- table_lr[2,5]
if (listing_sum_p < 0.05) {
print("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p, ".")
}
listing_sum_p <- table_lr[2,5]
if (listing_sum_p < 0.05) {
print(paste("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p, "."))
}
listing_sum_p <- table_lr[2,5]
if (listing_sum_p < 0.05) {
print(paste("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p,"."))
}
if (listing_sum_p < 0.05) {
print(paste("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p,"."))
}
if (listing_sum_p < 0.05) {
print(paste("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is",listing_sum_p,"."))
}
if (listing_sum_p < 0.05) {
print(paste("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", round(listing_sum_p, digits = 3),"."))
}
if (listing_sum_p < 0.05) {
print(paste("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", round(listing_sum_p, digits = 6),"."))
}
if (listing_sum_p < 0.05) {
print(paste("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p,"."))
}
listing_sum_p <- table_lr[2,5]
if (listing_sum_p < 0.05) {
print(paste("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p,"."))
} else {
print(paste("Based on the regresion analysis, there is no correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p,"."))
}
listing_sum_p <- table_lr[2,5]
if (listing_sum_p > 0.05) {
print(paste("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p,"."))
} else {
print(paste("Based on the regresion analysis, there is no correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p,"."))
}
listing_sum_p <- table_lr[2,5]
if (listing_sum_p < 0.05) {
text1 <- paste("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p,".")
} else {
text1 <- paste("Based on the regresion analysis, there is no correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p,".")
}
if (lengths(sig_neigh)/x_neigh) =< 0.2 {
if (lengths(sig_neigh)/x_neigh =< 0.2) {
if (lengths(sig_neigh)/x_neigh < 0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
}
if (nrow(sig_neigh)/x_neigh =<0.2)
if (nrow(sig_neigh)/x_neigh <=0.2)
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
if (length(sig_neigh)/x_neigh <=0.2)
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
}
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
}
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
} else (0.2 < length(sig-neigh)/x_neigh <=0.5) {
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
} else (0.2 < (length(sig-neigh)/x_neigh) <=0.5) {
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
} else (length(sig-neigh)/x_neigh > 0.2 & length(sig-neigh)/x_neigh <= 0.5{
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
} ifelse(length(sig-neigh)/x_neigh > 0.2 & length(sig-neigh)/x_neigh <= 0.5) {
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
} ifelse(0.2 < length(sig-neigh)/x_neigh <=0.5) {
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
} ifelse(0.2 < length(sig_neigh)/x_neigh <=0.5) {
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
} else if(length(sig-neigh)/x_neigh > 0.2 & length(sig-neigh)/x_neigh <= 0.5) {
text2 <- paste("The regression analysis indicates that some of Amsterdam neighborhoods have significantly different crime occurances. Thus", sig_neigh, "are significant in this regresion. As")
}
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
} else if(length(sig_neigh)/x_neigh > 0.2 & length(sig-neigh)/x_neigh <= 0.5) {
text2 <- paste("The regression analysis indicates that some of Amsterdam neighborhoods have significantly different crime occurances. Thus", sig_neigh, "are significant in this regresion. As")
}
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", sig_neigh, "are/is significant in this regresion. As")
} else if(length(sig_neigh)/x_neigh > 0.2 & length(sig_neigh)/x_neigh <= 0.5) {
text2 <- paste("The regression analysis indicates that some of Amsterdam neighborhoods have significantly different crime occurances. Thus", sig_neigh, "are significant in this regresion. As")
}
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", print(sig_neigh), "are/is significant in this regresion. As")
} else if(length(sig_neigh)/x_neigh > 0.2 & length(sig_neigh)/x_neigh <= 0.5) {
text2 <- paste("The regression analysis indicates that some of Amsterdam neighborhoods have significantly different crime occurances. Thus", print(sig_neigh), "are significant in this regresion. As")
}
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurances. Only", print(sig_neigh), "are/is significant in this regresion. As")
} else if(length(sig_neigh)/x_neigh > 0.2 & length(sig_neigh)/x_neigh <= 0.5) {
text2 <- paste("The regression analysis indicates that some of Amsterdam neighborhoods have significantly different crime occurances. Thus", print(sig_neigh), "are significant in this regresion. As")
}
listings_crime_dataset <-read.csv("../../temp-data/analysis/listings_crime_dataset.csv")
#Load all libraries we need here, in one code chunk even if they are used in different sections
library(dplyr)
library(ggplot2)
library(tidyverse)
library(broom)
x = nrow(listings_crime_dataset)
x_neigh = nrow(listings_crime_dataset %>%group_by(neighborhood) %>% summarise(count=n()))
x_period = nrow(listings_crime_dataset %>%group_by(periods) %>% summarise(count=n()))
df_listings = listings_crime_dataset %>% group_by(neighborhood) %>% summarise(total_listings = sum(listing_sum))
df_max_listings = df_listings[which.max(df_listings$total_listings),]
n_m_l = df_max_listings[1,1]
n_m_l_n = df_max_listings[1,2]
df_min_listings = df_listings[which.min(df_listings$total_listings),]
n_l_l = df_min_listings[1,1]
n_l_l_n = df_min_listings[1,2]
df_price = listings_crime_dataset %>% group_by(neighborhood) %>% summarise(average_price)
df_max_price = df_price[which.max(df_price$average_price),]
n_m_p = df_max_price[1,1]
n_m_p_n = df_max_price[1,2]
df_min_price = df_price[which.min(df_price$average_price),]
n_l_p = df_min_price[1,1]
n_l_p_n = df_min_price[1,2]
var_tab <- "
| Variable      | Description   | Data Class |
|---------------|:-------------:|----------:|
| neighborhood      | The respective neighborhood in Amsterdam to which the data pertains to. | Character |
| listing_sum      | The total amount of listings in the respective neighborhood. | Integer |
| average_price | The average price for listings in the respective neighborhood. | Integer |
| percentage_home_apt | The percentage of listings that are home apartments out of the amount of total listings. | Numeric |
| percentage_hotel_rool | The percentage of listings that are hotel rooms out of the amount of total listings. | Numeric |
| percentage_private_room | The percentage of listings that are private rooms out of the amount of total listings. | Numeric |
| percentage_shared_room | The percentage of listings that are shared rooms out of the amount of total listings. | Numeric |
| periods | The periods of time to which crime data pertains to. | Character |
| crime_type_category | The type of crime to which the data pertains to. | Character |
| total_crime_sum | The amount of crime occurances of a certain type in a certain period. | Integer |
"
cat(var_tab)
df_crime_time = filter(listings_crime_dataset, crime_type_category == "Total") %>% group_by(periods) %>% summarise(total_crime = sum(total_crime_sum))
df_crime_time%>%
ggplot(aes(x = periods, y = total_crime, group = 1)) + geom_point() + geom_path() +
labs(x = "Periods (Month)", y = "Total Crime Cases" , title = "Total Crime Occurrences per Month") +
theme(axis.text.x=element_text(size = 8))
df_min_crime_time = df_crime_time[which.min(df_crime_time$total_crime),]
c_l_p = df_min_crime_time[1,1]
c_l_p_n = df_min_crime_time[1,2]
df_max_crime_time = df_crime_time[which.max(df_crime_time$total_crime),]
c_m_p = df_max_crime_time[1,1]
c_m_p_n = df_max_crime_time[1,2]
df_crime_type = filter(listings_crime_dataset, crime_type_category != "Total") %>% group_by(crime_type_category) %>% summarise(total_crime_sum = sum(total_crime_sum))
df_crime_type %>%
ggplot(aes(x = crime_type_category, y = total_crime_sum, fill = crime_type_category)) + geom_bar(stat = 'identity') +
labs(x = "Crime Type", y = "Crime Occurances", fill = "Crime Type", title = "Total Crime Occurances per Crime Category") +
scale_fill_viridis_d() + theme(axis.text.x=element_text(size = 8))
df_min_crime_type = df_crime_type[which.min(df_crime_type$total_crime_sum),]
c_l_t = df_min_crime_type[1,1]
c_l_t_n = df_min_crime_type[1,2]
df_max_crime_type = df_crime_type[which.max(df_crime_type$total_crime_sum),]
c_m_t = df_max_crime_type[1,1]
c_m_t_n = df_max_crime_type[1,2]
regression_dataset <- listings_crime_dataset %>%
filter(crime_type_category == "Total")
lr <- lm(total_crime_sum ~ listing_sum + neighborhood, data = listings_crime_dataset)
table_lr <- tidy(lr,conf.int = FALSE)
table_lr <- na.omit(table_lr)
table_lr <- table_lr %>% mutate(term = str_replace_all(term, "neighborhood",""))
print(table_lr)
sig_neigh <- list()
for (row in 1:nrow(table_lr)) {
p.val <-table_lr[row,"p.value"]
if(p.val < 0.05) {
sig_neigh <- c(sig_neigh, table_lr[row,"term"])}
}
sig_neigh <- sig_neigh[-1]
listing_sum_p <- table_lr[2,5]
if (listing_sum_p < 0.05) {
text1 <- paste("Based on the regresion analysis, there is indeed correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p,".")
} else {
text1 <- paste("Based on the regresion analysis, there is no correlation between the amount of listings and crime occurances, as the p coefficient of listing_sum is", listing_sum_p,".")
}
else if(length(sig_neigh)/x_neigh > 0.2 & length(sig_neigh)/x_neigh <= 0.5) {
print(text2)
lr
summary(lr)
summary(lr)
summary(lr)
summary_lr <- summary(lr)
summary_lr
View(summary_lr)
summary_lr <- summary(lr$r.squared)
View(summary_lr)
summary_lr <- summary(lr)
table_lr_sum <- tidy(summary_lr, conf.int = FALSE)
View(table_lr_sum)
table_lr_sum <- na.omit(table_lr_sum)
r2 <- summary(lr)$r.squared
View(r2)
knitr::opts_chunk$set(echo = TRUE)
listings_crime_dataset <-read.csv("../../temp-data/analysis/listings_crime_dataset.csv")
#Load all libraries we need here, in one code chunk even if they are used in different sections
library(dplyr)
library(ggplot2)
library(tidyverse)
library(broom)
x = nrow(listings_crime_dataset)
x_neigh = nrow(listings_crime_dataset %>%group_by(neighborhood) %>% summarise(count=n()))
x_period = nrow(listings_crime_dataset %>%group_by(periods) %>% summarise(count=n()))
df_listings = listings_crime_dataset %>% group_by(neighborhood) %>% summarise(total_listings = sum(listing_sum))
df_max_listings = df_listings[which.max(df_listings$total_listings),]
n_m_l = df_max_listings[1,1]
n_m_l_n = df_max_listings[1,2]
df_min_listings = df_listings[which.min(df_listings$total_listings),]
n_l_l = df_min_listings[1,1]
n_l_l_n = df_min_listings[1,2]
df_price = listings_crime_dataset %>% group_by(neighborhood) %>% summarise(average_price)
df_max_price = df_price[which.max(df_price$average_price),]
n_m_p = df_max_price[1,1]
n_m_p_n = df_max_price[1,2]
df_min_price = df_price[which.min(df_price$average_price),]
n_l_p = df_min_price[1,1]
n_l_p_n = df_min_price[1,2]
var_tab <- "
| Variable      | Description   | Data Class |
|---------------|:-------------:|----------:|
| neighborhood      | The respective neighborhood in Amsterdam to which the data pertains to. | Character |
| listing_sum      | The total amount of listings in the respective neighborhood. | Integer |
| average_price | The average price for listings in the respective neighborhood. | Integer |
| percentage_home_apt | The percentage of listings that are home apartments out of the amount of total listings. | Numeric |
| percentage_hotel_rool | The percentage of listings that are hotel rooms out of the amount of total listings. | Numeric |
| percentage_private_room | The percentage of listings that are private rooms out of the amount of total listings. | Numeric |
| percentage_shared_room | The percentage of listings that are shared rooms out of the amount of total listings. | Numeric |
| periods | The periods of time to which crime data pertains to. | Character |
| crime_type_category | The type of crime to which the data pertains to. | Character |
| total_crime_sum | The amount of crime occurances of a certain type in a certain period. | Integer |
"
cat(var_tab)
df_crime_time = filter(listings_crime_dataset, crime_type_category == "Total") %>% group_by(periods) %>% summarise(total_crime = sum(total_crime_sum))
df_crime_time%>%
ggplot(aes(x = periods, y = total_crime, group = 1)) + geom_point() + geom_path() +
labs(x = "Periods (Month)", y = "Total Crime Cases" , title = "Total Crime Occurrences per Month") +
theme(axis.text.x=element_text(size = 8))
df_min_crime_time = df_crime_time[which.min(df_crime_time$total_crime),]
c_l_p = df_min_crime_time[1,1]
c_l_p_n = df_min_crime_time[1,2]
df_max_crime_time = df_crime_time[which.max(df_crime_time$total_crime),]
c_m_p = df_max_crime_time[1,1]
c_m_p_n = df_max_crime_time[1,2]
df_crime_type = filter(listings_crime_dataset, crime_type_category != "Total") %>% group_by(crime_type_category) %>% summarise(total_crime_sum = sum(total_crime_sum))
df_crime_type %>%
ggplot(aes(x = crime_type_category, y = total_crime_sum, fill = crime_type_category)) + geom_bar(stat = 'identity') +
labs(x = "Crime Type", y = "Crime Occurances", fill = "Crime Type", title = "Total Crime Occurances per Crime Category") +
scale_fill_viridis_d() + theme(axis.text.x=element_text(size = 8))
df_min_crime_type = df_crime_type[which.min(df_crime_type$total_crime_sum),]
c_l_t = df_min_crime_type[1,1]
c_l_t_n = df_min_crime_type[1,2]
df_max_crime_type = df_crime_type[which.max(df_crime_type$total_crime_sum),]
c_m_t = df_max_crime_type[1,1]
c_m_t_n = df_max_crime_type[1,2]
regression_dataset <- listings_crime_dataset %>%
filter(crime_type_category == "Total")
lr <- lm(total_crime_sum ~ listing_sum + neighborhood, data = listings_crime_dataset)
table_lr <- tidy(lr,conf.int = FALSE)
table_lr <- na.omit(table_lr)
table_lr <- table_lr %>% mutate(term = str_replace_all(term, "neighborhood",""))
print(table_lr)
sig_neigh <- list()
for (row in 1:nrow(table_lr)) {
p.val <-table_lr[row,"p.value"]
if(p.val < 0.05) {
sig_neigh <- c(sig_neigh, table_lr[row,"term"])}
}
sig_neigh <- sig_neigh[-1]
listing_sum_p <- table_lr[2,5]
if (listing_sum_p < 0.05) {
text1 <- paste("Based on the regression analysis, there is indeed correlation between the amount of listings and crime occurrences, as the p coefficient of listing_sum is", listing_sum_p,".")
} else {
text1 <- paste("Based on the regression analysis, there is no correlation between the amount of listings and crime occurrences, as the p coefficient of listing_sum is", listing_sum_p,".")
}
if (length(sig_neigh)/x_neigh <=0.2) {
text2 <- paste("The regression analysis indicates that a small number of Amsterdam neighborhoods have significantly different crime occurrences. Only", toString(sig_neigh), "are/is significant in this regression. Only", length(sig_neigh), "out of", x_neigh, "have significant p coefficients, it is noticeable that the relationship between the number of listings and crime occurrences is in large part unaffected by neighborhoods.")
} else if(length(sig_neigh)/x_neigh > 0.2 & length(sig_neigh)/x_neigh <= 0.5) {
text2 <- paste("The regression analysis indicates that some of Amsterdam neighborhoods have significantly different crime occurrences. Thus", toString(sig_neigh), "are significant in this regression. As", length(sig_neigh), "out of", x_neigh, "have significant p coefficients, it is noticeable that the relationship between the number of listings and crime occurrences is somewhat affected by neighborhoods.")
} else if(length(sig_neigh)/x_neigh > 0.5 & length(sig_neigh)/x_neigh <= 1) {
text2 <- paste("The regression analysis indicates that most of Amsterdam neighborhoods have significantly different crime occurrences. Thus,", toString(sig_neigh), "are significant in this regresion. As", length(sig_neigh), "out of", x_neigh, "have significant p coefficients, it is noticeable that the relationship between the number of listings and crime occurrences is to a large extent affected by neighborhoods.")
}
r2 <- summary(lr)$r.squared
if(r2 <= 0.5) {
text3 <- paste("Lastly, it is important to note that the R Squared of the correlation is", r2,".", "Meaning that most of the variation exhibited in this dataset is not explained through this correlation model.")
} else if (r2 >= 0.5) {
text3 <- paste("Lastly, it is important to note that the R Squared of the correlation is", r2,".", "Meaning that most of the variation exhibited in this dataset is explained through this correlation model.")
}
